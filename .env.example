# Settlement Engine Configuration

# ============================================================================
# APPLICATION
# ============================================================================
PORT=8000
WORKERS=4
LOG_LEVEL=INFO
ENVIRONMENT=development
APP_NAME="Real-Time Transaction Settlement System"
APP_VERSION="1.0.0"

# ============================================================================
# DATABASE (PostgreSQL)
# ============================================================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=settlement
POSTGRES_PASSWORD=settlement_pwd_dev
POSTGRES_DB=settlement_engine
POSTGRES_POOL_SIZE=20
POSTGRES_POOL_RECYCLE=3600
DATABASE_URL=postgresql+psycopg2://settlement:settlement_pwd_dev@postgres:5432/settlement_engine

# ============================================================================
# REDIS (Cache & Idempotency)
# ============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=""
REDIS_POOL_SIZE=10
REDIS_SOCKET_KEEPALIVE=True
REDIS_SOCKET_KEEPALIVE_OPTIONS=1,1,3

# Idempotency key TTL (seconds)
IDEMPOTENCY_TTL=86400  # 24 hours

# ============================================================================
# KAFKA (Message Queue)
# ============================================================================
KAFKA_BOOTSTRAP_SERVERS=kafka:9092
KAFKA_PARTITIONS=10
KAFKA_REPLICATION_FACTOR=3
KAFKA_COMPRESSION_TYPE=snappy
KAFKA_ACKS=all
KAFKA_RETRIES=3
KAFKA_LINGER_MS=10

# Topics
KAFKA_INTAKE_TOPIC=transactions.intake
KAFKA_BATCHING_TOPIC=batches.optimized
KAFKA_SETTLEMENT_TOPIC=settlements.confirmed
KAFKA_LEDGER_TOPIC=ledger.events

# ============================================================================
# ETCD (Consensus & Raft)
# ============================================================================
ETCD_ENDPOINTS=http://etcd:2379
ETCD_TIMEOUT=10
ETCD_GRPC_TIMEOUT=30

# Raft configuration
RAFT_TERM_TIMEOUT=150
RAFT_HEARTBEAT_INTERVAL=30
CONSENSUS_QUORUM_SIZE=3

# ============================================================================
# SETTLEMENT ENGINE
# ============================================================================

# Transaction limits
MAX_TRANSACTION_AMOUNT=999999999.99
MIN_TRANSACTION_AMOUNT=0.01
DEFAULT_SETTLEMENT_WINDOW=rtgs  # rtgs, t0, t1, t2

# Batching configuration
BATCH_MAX_SIZE=1000
BATCH_MIN_SIZE=10
BATCH_TIMEOUT_SECONDS=300  # 5 minutes
BATCH_OPTIMIZATION_ENABLED=True
BATCH_SOLVER_TIMEOUT=100  # milliseconds

# Optimization
FX_SPREAD_USD_EUR_BPS=25  # 2.5 basis points
FX_SPREAD_USD_GBP_BPS=30  # 3.0 basis points
FX_SPREAD_USD_JPY_BPS=20  # 2.0 basis points
WIRE_COST_USD=5.00
CONSOLIDATION_DISCOUNT_PERCENT=15

# Settlement windows
RTGS_ENABLED=True
T0_SETTLEMENT_ENABLED=True
T1_SETTLEMENT_ENABLED=True
T2_SETTLEMENT_ENABLED=True

# ============================================================================
# LIQUIDITY & FORECASTING
# ============================================================================
FORECASTING_MODEL=prophet  # prophet, lstm, arima
FORECASTING_DAYS_AHEAD=7
FORECASTING_CONFIDENCE_LEVEL=0.95
LIQUIDITY_RECHECK_INTERVAL=300  # seconds
LIQUIDITY_ALERT_THRESHOLD_PERCENT=80  # Alert when 80% used

# ============================================================================
# RISK MANAGEMENT
# ============================================================================
COUNTERPARTY_EXPOSURE_LIMIT_USD=50000000
COUNTERPARTY_CREDIT_RATING_REQUIRED=True
CREDIT_RATING_WEIGHT_AA=0.9
CREDIT_RATING_WEIGHT_A=0.7
CREDIT_RATING_WEIGHT_BBB=0.5
RISK_ALERT_THRESHOLD=high  # low, medium, high, critical

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================
PROMETHEUS_ENABLED=True
PROMETHEUS_PORT=8001
PROMETHEUS_METRICS_PATH=/metrics

GRAFANA_ENABLED=True
GRAFANA_HOST=grafana
GRAFANA_PORT=3000
GRAFANA_API_KEY=admin

# Logging
LOG_FORMAT=json  # json, text
LOG_TO_FILE=False
LOG_FILE_PATH=/var/log/settlement-engine.log
LOG_RETENTION_DAYS=30

# Tracing (OpenTelemetry)
TRACING_ENABLED=False
TRACING_SAMPLE_RATE=0.1
JAEGER_AGENT_HOST=localhost
JAEGER_AGENT_PORT=6831

# ============================================================================
# SECURITY
# ============================================================================
SECURE_MODE=True
API_KEY_ENABLED=False  # Set to True in production
API_KEY=your_api_key_here

# JWT Configuration
JWT_SECRET_KEY=your_secret_key_here_change_in_production
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# CORS
CORS_ORIGINS=*
CORS_ALLOW_CREDENTIALS=True
CORS_ALLOW_METHODS=*
CORS_ALLOW_HEADERS=*

# ============================================================================
# DEPLOYMENT
# ============================================================================
DOCKER_REGISTRY=docker.io
DOCKER_IMAGE_TAG=latest
KUBERNETES_NAMESPACE=default
KUBERNETES_REPLICAS=3

# ============================================================================
# FEATURE FLAGS
# ============================================================================
FEATURE_SMART_BATCHING=True
FEATURE_CONSENSUS=True
FEATURE_LIQUIDITY_FORECASTING=True
FEATURE_RISK_MONITORING=True
FEATURE_CHAOS_TESTING=False
FEATURE_DEBUG_MODE=False

# ============================================================================
# MAINTENANCE
# ============================================================================
MAINTENANCE_MODE=False
ALLOW_SCHEMA_MIGRATION=True
ALLOW_DATA_RESET=False  # DANGER: Only in dev!
